version: 0.1
component: build
timeoutInSeconds: 6000
runAs: root
shell: bash
env:
  variables: null
  vaultVariables:
    DB_PASSWORD_VALUE: ${DATA_SOURCE_PASS_OCID_VALUE}
  exportedVariables:

steps:
- type: Command
  timeoutInSeconds: 6000
  name: DB Setup
  command: |
    cd ${OCI_PRIMARY_SOURCE_DIR}/DB-Setup
    yum install -y mysql
    mysql --password=${DB_PASSWORD_VALUE} --user=${DB_USERNAME} --port=${DB_PORT} --host=${DB_SERVER} <setup.sql
  onFailure:
  - type: Command
    command: |
      echo "Handling Failure"
      echo "Failure successfully handled"
    timeoutInSeconds: 40
    runAs: root